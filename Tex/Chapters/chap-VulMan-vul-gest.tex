%-------------------------------------
% Chapitre
% Vulnerability Management
% Gestion
% File : chap-Vulman-gest.tex
%--------------------------------------
\uchap{Introduction sur les vulnérabilités, chapitre 3.1}
\uchap{\jobname}
%_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_

\section{Gérer ses vulnérabilités}
\label{CHAP_GESTVUL}

Dans le paysage numérique de plus en plus complexe , nous sommes exposés à des terminologies variées souvent soutenues par les modes du moment. Les termes «analyse de vulnérabilités», «évaluation des vulnérabilités» et «gestion des vulnérabilités» sont souvent utilisés et restent une source de confusion pour nombre d’entre nous. Pour nous assurer de se concentrer sur les tactiques les plus efficaces pour gérer les vulnérabilités, nous donnerons les principales différences entre l’évaluation des vulnérabilités et la gestion des vulnérabilités. Mais en posant comme principe que l'important est d'agir quand sont identifiées des failles dans un système.
 La gestion des vulnérabilités est donc un processus de gestion des risques associés à la présence de vulnérabilités qui se base sur la recherche de celles-ci, l'évaluation de leur impact et qui pilote le calendrier d’application des correctifs disponibles.

\begin{itemize}
\item La gestion des vulnérabilités (\textbf{Vulnerability Management}) est un processus continu servant à identifier, classer, corriger et réduire les vulnérabilités, en particulier dans les logiciels. La gestion des vulnérabilités fait partie intégrante des processus de gestion de la cybersécurité dans l’entreprise. Contrairement au projet d’évaluation ponctuelle des vulnérabilités, une stratégie de gestion des vulnérabilités fait référence à un processus ou programme complet et continu qui vise à gérer les vulnérabilités d’une organisation de manière globale et continue. Nous avons rassemblé quelques caractéristiques et éléments clés d’une approche standard de la gestion des vulnérabilités.
La gestion des vulnérabilités comprend aussi le processus par lequel  les risques associés ces vulnérabilités sont évalués. Cette évaluation conduit à corriger les vulnérabilités et éliminer le risque ou une acceptation formelle du risque par le gestion d’une organisation (par exemple, au cas où l’impact d’une attaque serait faible ou la le coût de la correction ne dépasse pas les dommages éventuels pour l’organisation).
\item Il est souvent confondu avec l’évaluation des vulnérabilités (\textbf{Vulnerability Assessment}), dont l’objectif est de rechercher les fragilités d’un système ou d’une entreprise. Ces vulnérabilités connues sont recherchées sur le système. Une évaluation de vulnérabilité n'est pas une analyse, c'est un projet ponctuel avec une date de début et une date de fin définies. En règle générale, un consultant externe en sécurité de l'information examine votre environnement d'entreprise et identifie diverses vulnérabilités potentiellement exploitables auxquelles vous êtes exposé dans un rapport détaillé. Le rapport répertoriera non seulement les vulnérabilités identifiées, mais fournira également des recommandations concrètes pour la résolution. Une fois le rapport final préparé, l'évaluation de la vulnérabilité est terminée.
Malgré le fait que les deux sont liés, il existe une différence importante entre les deux. La recherche de vulnérabilités consiste à utiliser par exemple un programme informatique pour identifier les vulnérabilités dans réseaux, infrastructure informatique ou applications. La gestion de la vulnérabilité est la processus entourant ce scan de vulnérabilités, prenant également en compte d’autres aspects tels que acceptation des risques, remédiation, etc. On vera en outre que le scan de vulnérabilités n’est qu’un sous partie de l’évaluation des vulnérabilité.
\item L’analyse des vulnérabilités est un processus de recherche ces fragilités et des scénario qui vont permettre de les exploiter. Les tests d’intrusion sont un exemple de cette dynamique d’analyse des fragilités afin d’en définir un scénario permettant d’atteindre l’objectif que l’attaquant s’est assigné.
\end{itemize}


% Begin PRZ ===========================
\begin{frame}
\frametitle<presentation>{gestion des vulnérabilités}
% end header PRZ =======================
\upicture{../Tex/Pictures/img-vul-process}{La gestion des vulnérabilités}{01}{lbl-vulprocess}
\end{frame}
% end PRZ ===========================


%============================
% La gestion des Vulnérabilités - patch management et co
%--------------------------------------------------
\subsection{Processus de gestion des vulnérabilités}

% décrire le processus de gestion avec Inventaire / Analyse / ....
La gestion des vulnérabilités est un processus continu. Elle apparait en en toile de fond du cycle de vie du Maintien en Condition de sécurité :

% Begin PRZ ============
\begin{frame}
\frametitle<presentation>{Cycle de vie VULMAN}
% end header PRZ ===========
\begin{itemize}
	\item Cartographier, cataloguer l'environnement; 
	\item Identifier les fragilités et les menaces;
	\item Corriger, remédier, améliorer la protection et la défense;
	\item Mesurer et suivre l'efficacité les mesures déployées.
\end{itemize}
\end{frame}
% end PRZ ============


\subsubsection{ISO 27001}

Un chapitre de la norme c parle de Veille de la vulnérabilités, que nous pouvons classer dans le domaine de la gestion des vulnérabilités et donne des éléments méthodologiques : 

% Begin PRZ ===========================
\begin{frame}
\frametitle<presentation>{ISO 27001}
% end header PRZ =======================
\begin{itemize}
	\item 1. \textbf{DÉCOUVRIR} : Catalogage de l’existant, des actifs, des ressources du système d’information. 
 	\item 2. \textbf{PRIORISER} : Classifier et attribuer des valeurs quantifiables aux ressources, les hiérarchiser. 
 	\item 3. \textbf{ÉVALUER} : Identifier les vulnérabilités ou les menaces potentielles sur chaque ressource. 
	 \item 4. \textbf{SIGNALER} : Signaler, publier les vulnérabilités découvertes. 
 	\item 5. \textbf{CORRIGER} : Éliminer les vulnérabilités les plus sérieuses des ressources les plus importantes. 
 	\item 6. \textbf{VÉRIFIER} : S’assurer que la vulnérabilité a bien été traitée. 
\end{itemize}

\end{frame}
% end PRZ ===========================


%C'est un processus intégré à la gouvernance de la sécurité.


%	Penser la gestion de vulnérabilités 
	
%	
%Évaluation de la vulnérabilité
%Comme mentionné précédemment, une évaluation de vulnérabilité représente en elle-même un élément crucial d'un cadre de gestion des vulnérabilités et est considérée comme le premier pas vers l'amélioration de votre sécurité informatique. De nombreuses entreprises doivent encore faire face à un vaste pool d’actifs inconnus, de périphériques réseau mal configurés, d’environnements très segmentés, d’outils incompatibles ou tout simplement de trop d’informations à analyser et à traiter. Une évaluation des vulnérabilités présente de nombreux avantages et identifie les actifs clés de votre organisation, détermine les vulnérabilités qui menacent la sécurité de ces actifs, fournit des recommandations pour renforcer votre posture de sécurité et vous aide à réduire les risques, vous permettant ainsi de mieux cibler vos ressources informatiques. .
%
%L'analyse des vulnérabilités  permettra un inventaire complet de tous les logiciels et de leurs versions précises, ainsi que la possibilité de vérifier les configurations de sécurité de base et de détecter les vulnérabilités. Ces analyses de vulnérabilité doivent être annoncées pour permettre le signalement des analyses non autorisées et faciliter la visibilité des modifications apportées au réseau et aux actifs. Les processus d'analyse doivent être documentés et examinés pour favoriser leur maturité.
%
%Une fois les évaluations de vulnérabilité effectuées, il est essentiel de produire des rapports clairs et facilement compréhensibles avec des tâches de correction hiérarchisées. Quel que soit l’outil d’analyse de vulnérabilité utilisé, il devrait permettre de produire des rapports, de marquer les vulnérabilités comme ayant été corrigées ou non détectées, de suivre l’âge des vulnérabilités, etc. Avant de publier les rapports, l’organisation doit s’accorder sur le format du rapport afin de s’assurer que les éléments sont inclus / surlignés et les éléments non pertinents sont supprimés. Comme pour de nombreux autres processus de sécurité critiques, il est vivement recommandé que la direction générale adhère pleinement au processus de signalement et de correction des vulnérabilités.


\subsubsection{Fenêtre d'exposition}

%==============
% Analyse / recherche des Vulnérabilités
%------------------------

Dans un monde idéal où en  temps réel, on accéderait à l'apparition d'une vulnérabilité, ou on pourrait la détecter sur son SI, et patcher avec le correctif publié par l'éditeur, la gestion des vulnérabilités se cantonnerait à constater la fenêtre d’exposition générée par le temps nécessaire à l’éditeur pour publier un correctif immédiatement déployé.

% Begin PRZ ===========================
\begin{frame}
\frametitle<presentation>{Fenêtre d'exposition idéale}
% end header PRZ =======================
\upicture{../Tex/Pictures/img-vul-patchtimeideal}{Fenêtre d'exposition idéale}{01}{lbl-vul-patchtimeideal}
\end{frame}
% end PRZ ===========================

L’unique décision pour un RSSI serait  serait une gestion du risque simple liée à la décision de  de déconnecter ou pas un élément vulnérable du SI pendant la fenêtre d’exposition. Tous les correctifs disponibles seraient appliqués dès qu’ils sont disponibles.

Même si l’information peut être accessible en temps réel, la détection de la présence d’une vulnérabilité sur le SI dépend de la fréquence des « scans » ou des audits de l’organisation, ou la connaissance parfaite du SI via une CMDB à jour. Ainsi, la fenêtre d’exposition apparaît naturellement à plusieurs niveaux quelle que soit la réactivité du service de gestion des vulnérabilités.

 L’application d’un correctif nécessite une fenêtre de maintenance et un arrêt du service. Au mieux, ces fenêtres de maintenance sont prévues et planifiées, au pire, l’application de correctifs est interdite hors mode projet (notamment sur certains réseaux opérationnels et industriels). Par ailleurs, la planification et l’application d’un correctif, même dans le meilleur des cas, est extrêmement chronophage pour les équipes techniques.
 
% Begin PRZ ===========================
\begin{frame}
\frametitle<presentation>{Fenêtre d'exposition}
% end header PRZ =======================
\upicture{../Tex/Pictures/img-vul-patchtime}{Fenêtre d'exposition}{01}{lbl-vul-patchtime}
\end{frame}
% end PRZ ===========================

Tous les correctifs  pour une même vulnérabilités ne peuvent pas être déployés au même rythme sur tous les systèmes. La gestion des vulnérabilités se structure donc autour de la gestion des priorités basée sur les risques contextuels évalués sur la base  

\begin{itemize}
  \item du niveau de criticité de la vulnérabilité (c’est à dire ce que son exploit permet de réaliser ou d’obtenir – de nombreux services de veille s’appuient sur le Framework CVSS pour classer les vulnérabilités)
  \item du niveau de criticité pour l’organisation des systèmes et services avérés vulnérables.
\end{itemize}


Il est important de disposer d'un accès à un service  de d'information (renseignement) sur les vulnérabilités et sur les Menaces (cf. CERT commercial) afin de de collecter et d’organiser le renseignement extérieur et de le croiser avec le renseignement issu de l’interne (détections, incidents, ...) afin d’identifier l'information prioritaire, de l’enrichir et de la diffuser vers les opérations de sécurité. 
 
Un tel service peut être en mesure d’associer une vulnérabilité à un adversaire, à une phase d’attaque, et à une technique particulière employée dans cette phase d’attaque (Cf. Framework MITRE ATTACK facilite notamment un tel niveau de précision et d’analyse).

%TODO Lien MITRE

Il est ainsi possible de mettre en exergue les vulnérabilités exploitées par les adversaires et les campagnes jugées prioritaires  ciblant l’organisation. Cette information sur l’adversaire peut être alors disséminée à des équipes de gestion des vulnérabilités et utilisée pour prioriser l’application des correctifs.



\subsubsection{Processus d’analyse/recherche des vulnérabilités}

Avant de se lancer dans la dynamique classique des audits de sécurité (qui permettent de trouver des vulnérabilité), on peut positionner des mécanismes de recherches de vulnérabilités dans le cycle de vie d'un système sous la forme des différentes étapes des cycles V et V (Vérification et validation) d'un projet.

% TODO les techniques pour recherches les vulnérabilités techniques (Stack Overflow)
% TODO Le secteurs éconmoique de la vulnérabilité. (les failles une business line).

% Begin PRZ ===========================
\begin{frame}
\frametitle<presentation>{Quand rechercher des vulnérabilités}
% end header PRZ =======================
\begin{itemize}
  \item \textbf{Phase de conception} : recherche des défauts et fragilités de conception avec des techniques d'analyse de risque, de revue de conception avec des analyses de menaces
  \item \textbf{Phase de développement} : pendant la phase de développement il existe de nombreux outils d'audit de code statique qui offre l'assistance au développeurs pour éviter les erreurs les plus classiques,
  \item \textbf{Phase de validation} : dans cette phase, il est possible d'utiliser des techniques et méthodologies classiques d'audit de sécurité (Pentest, analyse de code, ...)
  \item \textbf{Phase de vérification opérationnelle} en Pré-Production ou en production : dans cette phase c'est généralement de l'audit dynamique de type scan de vulnérabilité et tests d'intrusion.
\end{itemize}
\end{frame}
% end PRZ ===========================

Contrairement à l’évaluation des vulnérabilités, un programme complet de gestion des vulnérabilités n’a pas de date de début ni de fin définie, mais constitue un processus continue.

\subsubsection{Processus d’évaluation des vulnérabilités (Vulnerability Assessement)}

%TODO la recherche de vulérabilité SERODIUM

L'évaluation permet de définir l'impact d'une vulnérabilité sur les risques courus par l'entreprise dans une dynamique d'audit ponctuelle ou récurrente?..


%=====================
% Evaluation des Vulnérabilités 
%--------------------------------------

%. Le vulnerability assessement



% Begin PRZ ===========================
\begin{frame}
\frametitle<presentation>{Rechercher ses vulnérabilités}
% end header PRZ =======================
\upicture{../Tex/Pictures/img-vulsearch}{Rechercher ses vulnérabilités}{1}{lbl-vulcycle}
\end{frame}
% end PRZ ===========================


\subsection{Audit sécurité des vulnérabilités}

Les audits de sécurité se conduisent souvent sur une base d'audit de vulnérabilités suivi de l'exploitation des ces vulnérabilités ou fragilités pour construire des scénarios plausibles et de caractériser des risques à forte probabilités ou fort impact.
On distingue cependant :
\begin{itemize}
	\item les scans de vulnérabilités, permettant de manière automatisée à rechercher les vulnérabilités sur un système donné, et qui se base sur des bases de vulnérabilités connues
	\item les audits techniques et pentests, qui peuvent se baser en premier lieu sur des scans pour identifier les vulnérabilités connues, mais qui travaille aussi sur la recherche de vulnérabilités.
\end{itemize}

%\subsubsection{Scan de Vulnérabilités}
%Un processus nécessaire qui peut être utilisé de manière récurrente.

\subsubsection{Scan de Vulnérabilités du système}

Les vulnérabilités peuvent être découvertes à l'aide d'un scanner de vulnérabilités, qui analyse un système informatique à la recherche de vulnérabilités connues, telles que les ports ouverts, les configurations logicielles non sécurisées et la vulnérabilité aux infections par logiciels malveillants. Des tests de fuzz peuvent permettre de détecter des vulnérabilités inconnues, telles que le jour zéro, permettant d'identifier certains types de vulnérabilités, telles qu'un débordement de mémoire tampon avec des cas de test pertinents. Une telle analyse peut être facilitée par l’automatisation des tests. 

\subsubsection{Scan de Vulnérabilités logicielles}

La correction des vulnérabilités peut impliquer de différentes manières l’installation d’un correctif, une modification de la stratégie de sécurité du réseau, la reconfiguration du logiciel ou la formation des utilisateurs à l’ingénierie sociale.


\section{La gestion des correctifs}

Le patch management est un processus permettant cette gestion des correctifs de sécurité et leur déploiement en entreprise.

%TODO relecture

En anglais, ce patch management consiste à industrialiser les processus de détection, d'analyse et de déploiement des mises à jours de sécurité logicielles. En effet, lorsqu'un éditeur publie un nouveau patch de sécurité relatif à son produit, ses clients ne sont pas toujours en mesure d'évaluer l'importance de ce dernier ni les risques de son installation. Les solutions de gestion des correctifs proposent alors de stocker localement les correctifs sur un serveur du client, puis d'évaluer l'impact de celui-ci avant éventuellement de le tester puis de l'installer.

\subsection{de l'outillage}

%TODO relecture

La force d'un outil de gestion des correctifs vient d'abord de sa base de données. C'est elle qui référence le parc informatique existant et conserve l'historique de l'installation des patchs. Elle permet à tout instant de revenir en arrière après installation d'un correctif ou de déterminer précisément où doivent être installés les patchs de sécurité.
Par cette base de connaissance, les logiciels de gestion de correctifs facilitent la détection d'incompatibilités logicielles ou matérielles avec un correctif de sécurité car chaque patch donne lieu à une validation fonctionnelle. Les correctifs installés ceux des éditeurs et dépendent donc de leurs délais de publication.

\section{Les audits}

% Begin PRZ ===========================
\begin{frame}
\frametitle<presentation>{Caractéristiques d'audit}
% end header PRZ =======================

Les audits de vulnérabilités s'inscrivent généralement dans des processus de sécurité d'entreprise ou de projets

Les audits peuvent être de natures différentes :

\begin{itemize}
  \item Audit Organisationnel : pour découvrir les fragilités organisationnelles et humaines
  \item Audit technique : pour découvrir et analyser les fragilités 
\end{itemize}

On peut avoir besoin de ces audits pour des enjeux différents :

\begin{itemize}
  \item Audit de conformité
  \item Audit de vérification et de validation
  \item Audit de contrôle et d'inspection
\end{itemize}

Avec une dynamique d'audit :  

\begin{itemize}
 	\item  Audits ponctuels et campagnes d'audit
	\item  Audit continu
\end{itemize}

\end{frame}
% end PRZ ===========================

\begin{warningbox}{Fiche TECHNO : Les audits}
 Les sujets autour des techniques, méthodologies d'audit informatique liées à la sécurité sont une bonne source de réflexion pour les fiches technos.
\end{warningbox}





