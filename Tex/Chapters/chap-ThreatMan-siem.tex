soar%-------------------------------------------------------------
%               FR CYBERDEF SECOPS COURSE
%              $Chapitre : Threat Management
%                   $theme : Threat Detection
%               $File :  chap-ThreatMan-siem.tex
%                             2020 eduf@ction
%-------------------------------------------------------------
\uchap{chap-ThreatMan-siem.tex}
%-------------------------------------------------------------

% SOURCE https://www.logpoint.com/fr/comprendre/quest-ce-que-le-siem/
% SOURCE https://www.nomios.fr/type-de-solution-siem/
% SOURCE https://www.splunk.com/fr_fr/form/7-siem-trends-to-watch-in-2019.html

\subsection{SIEM, une technologie}

\subsubsection{SIEM et Logs}

% Begin PRZ ===========================
\begin{frame}
\frametitle<presentation>{SIEM et Log}
\framesubtitle<presentation>{Threat and leak}
% end header PRZ =======================
Puisque nous disposons maintenant d'une capacité de capter de l'information pertinente pour détecter des attaques, que nous avons une architecture de collecte,  ainsi qu'une architecture de stockage et de filtrage, nous pouvons injecter des informations dans des outils de recherche et de corrélation d'attaque.
Ceci pour peu que l'architecture et les outillages puissent suivre la charge d'analyse en temps réel.

Il ne faudra pas aussi oublier que les traces informatiques et réseaux ne sont pas les seules sources d'information nécessaires à la détection d'attaques (en temps réel ou différé), il faut aussi connecter des sources de menaces : 
\begin{itemize}
  \item \textbf{Threat Intelligence Database }:  IOC et identifiants des sources malveillantes (IP, noms de domaine, serveur mail ...)
  \item  \textbf{Leak} : Fuite de données détectés par la surveillance du Web et du Darknet.
\end{itemize}

\end{frame}
% end PRZ ===========================


\subsubsection{Un peu d'histoire}

Le SIEM (\textit{Security Information and Event Management})  est aujourd'hui l'aboutissement d'un voeu  très ancien des responsables sécurité qui supervisent depuis bien des décennies des systèmes de contrôle périmétrique : Corréler tous les évènements de fonctionnement sur l'ensemble des équipements. 

Le SIEM se définit donc comme la collecte, la surveillance, la corrélation et l’analyse en temps réel d'événements fonctionels et techniques provenant de sources disparates. Les solutions SIEM d’aujourd’hui permettent à l'entreprise de réagir rapidement et avec suffisamment de traçabilité et d'éléments techniques pour  accélérer l'analyse et la réponse à incident.
Une solution SIEM assure la gestion, l’intégration, la corrélation et l’analyse généralement en seul lieu, ce qui facilite la surveillance et la résolution des problèmes des infrastructures hétérogènes, complexes et distantes. Sans ce type d'outillage, un analyste de sécurité doit passer en revue des millions de données non comparables, stockées dans des « silos » pour chaque matériel, chaque logiciel et chaque source de sécurité. Un SIEM est donc avant tout un outil de fédération des évènements de sécurité.

L'acronyme SIEM ou «gestion des informations de sécurité» fait référence à des technologies combinant à la fois la gestion des \textbf{informations} de sécurité et la gestion des \textbf{événements} de sécurité. Comme ils sont déjà très similaires, le terme générique plus large peut être utile pour décrire les outils récents  qui conjuguent. Là encore, il est essentiel de différencier la surveillance des événements de la surveillance des informations générales. Un autre moyen essentiel de distinguer ces deux méthodes consiste à considérer la gestion des informations de sécurité comme une sorte de processus à long terme ou plus large, dans lequel des ensembles de données plus diversifiés peuvent être analysés de manière plus méthodique. En revanche, la gestion des événements de sécurité examine à nouveau les types d’événements utilisateur pouvant constituer des signaux d’alerte ou indiquer aux administrateurs des informations spécifiques sur l’activité du réseau.

C'est souvent l'usage d'un SIEM dans une ambiguïté de gestion long terme de la sécurité en tant que propriété d'un système d'une part, et la gestion court terme de l'urgence d'une attente à la sécurité qui pose problème dans les projets et dans les opérations.
 
 Ce genre d'outillage est passé par différentes étapes de maturation avec des SIM et SEM  et enfin des SIEM.
Il s’agit de combiner les fonctions de gestion des informations (SIM, Security Information Management) et des évènements  (SEM, Security Event Management) en un seul système de management de sécurité.

\begin{itemize}

	\item dans la gestion des informations de sécurité (SIM) , la technologie consiste  à collecter des informations à partir des journaux d'équipement de sécurité, qui peut consister en différents types de données. Globalement on peut dire qu'un SIM est aimantant important pour des équipes de supervision de la sécurité périmétrique. d'une part pour la traçabilité et le reporting de sécurité.
	\item technologies spécialement conçues pour rechercher des authentifications suspectes, des ouvertures de session sur un compte ou des accès de gestion de haut niveau à des heures précises du jour ou de la nuit.
\end{itemize}

Bien qu'outillant des processus très similaires mais distincts, les trois acronymes SEM, SIM et SIEM ont tendance à être confus ou à causer de la confusion chez ceux, peu familiarisés avec les processus de sécurité.
La similitude entre la gestion des événements de sécurité ou SEM et la gestion des informations de sécurité ou SIM est au cœur du problème.

Ces deux types de collecte d'informations concernent la collecte d'informations de journal de sécurité ou d'autres données similaires en vue d'un stockage à long terme, ou l'analyse de l'environnement de sécurité d'un réseau. Quoi qu'il en soit, de nos jours le terme SIEM est utilisé quelque soit d'ailleurs l'usage.

% SOURCE https://www.linkbynet.com/fr/recourir-a-un-siem

Plus concrètement, un système de type SEM centralise le stockage et l’interprétation des logs en temps réel et permet une analyse. Les experts en cyber sécurité peuvent ainsi prendre des mesures défensives plus rapidement. Un système de type SIM collecte pour sa part des données et les place dans un référentiel à des fins d’analyse de tendances. Dans ce cas, la génération de rapports de conformité est automatisée et centralisée.

Le SIEM, qui regroupe ces 2 systèmes, accélère donc l’identification et l’analyse des événements de sécurité, atténue les conséquences d’attaques et facilite la restauration qui s’ensuit. Pour y parvenir, il collecte les événements, les stocke (avec normalisation) et agrège des données pertinentes mais non structurées issue de plusieurs sources. L’identification des écarts possibles par rapport à la moyenne / norme nourrit la prise de décision. En outre, les tableaux de bord générés contribuent à répondre aux exigences légales de conformité de l’entreprise.

En d’autres termes, avec le SIEM les équipes de sécurité opérationnelle industrialisent la surveillance tout en simplifiant l’analyse de multiples sources d’événements de sécurité (antivirus, proxy, Web Application Firewall…). La corrélation des événements provenant d’applications ou d’équipements très variés est aussi facilitée. De quoi détecter des scénarios de menaces avancées.

Dans la pratique, Il existe 3 grandes manières d'opérer ou de faire opérer un SIEM :

\begin{itemize}
  \item SIEM  déployé et intégré dans l'entreprise;
  \item SIEM basé dans le cloud;
  \item SIEM géré / managé en mode MSSP.
\end{itemize}

S'équiper d’une solution de type SIEM nécessite encore un investissement conséquent en raison de la complexité de la mise en œuvre des gros outils du marché. Toutefois, bien qu’initialement destiné aux grandes entreprises, le SIEM peut être déployer dans tous les types d’organisations, même les plus petits, avec des solutions de plus en plus automatisées. Toutefois, il ne faudra pas oublier que la configuration d'un SIEM (création de scénario de détection (USE CASE) demande de la ressource et des compétences spécifiques.
Par ailleurs, l'important sera par la suite de définir quel type de réaction à la suite de la détection d'un évènement à risque.


Un SIEM s’avère capable de détecter des incidents de sécurité qui seraient passés inaperçus. Pour une raison simple : les nombreux hôtes qui enregistrent des événements de sécurité ne disposent pas de fonctions de détection d’incidents.

Le SIEM dispose d'une fonction de détection grâce à sa capacité de corrélation des événements. Contrairement à un système de prévention d’intrusion qui identifie une attaque isolée, le SIEM regarde au-delà. Les règles de corrélations lui permettent d’identifier un événement ayant causé la génération de plusieurs autres (hack via le réseau, puis manipulation sur un équipement précis…).

Dans de tels cas de figure, la plupart des solutions ont la capacité d’agir indirectement sur la menace. Le SIEM communique avec d’autres outils de sécurité mis en place dans l’entreprise (Exemple pare-feu) et pousse une modification afin de bloquer l’activité malveillante. Résultat, des attaques qui n’auraient même pas été remarquées dans l’entreprise sont contrecarrées.

% Begin PRZ ===========================
\begin{frame}
\frametitle<presentation>{Fonction SIEM}
% end header PRZ =======================
\begin{itemize}
  \item la première fonction d'un SIEM est déjà de corréler les événements provenant des composants de sécurité;
  \item la deuxième  fonction de corréler des événement de comportement du SI;
  \item la troisième fonction de corréler avec des événements externes au SI sur la base de capteurs externes (threats intelligence de type renseignement).
\end{itemize}
\end{frame}
% end PRZ ===========================


\mode<all>{\picframe{Tex/Pictures/img-siem}{architecture d'un SIEM}{0.8}{lbl-siem}}

Pour aller encore plus loin, une organisation peut choisir d’intégrer à son SIEM,  une Cyber Threat Intelligence (CTI ou Flux de renseignement sur les menaces). 

Selon la définition de Gartner, la Cyber Threat Intelligence (CTI) est la connaissance fondée sur des preuves, y compris le contexte, les mécanismes, les indicateurs, les implications et des conseils concrets, concernant une menace nouvelle ou existante ou un risque pour les actifs d’une organisation qui peuvent être utilisés afin d’éclairer les décisions concernant la réponse du sujet à cette menace ou un danger.

La CTI consiste donc à collecter et organiser toutes les informations liées aux menaces et cyber-attaques, afin de dresser un portrait des attaquants ou de mettre en exergue des tendances (secteurs d’activités visés, les méthodes d’attaque utilisées, etc.). Résultat, une meilleure anticipation des incidents aux prémices d’une attaque d’envergure.

 \subsection{la détection d'incidents}

\subsubsection {Collecter les logs }
\textbf{COLLECTE}  : Le premier acte est d'alimenter le système avec les «logs» des composants du système d’information (outils de sécurité comme les IDS, IPS, «HoneyPot», Pare-feu, etc… que ceux des autres composants comme les équipements réseaux, les serveurs mandataires, de fichier, de mail, les services dans le nuage, etc…);
\subsubsection {Normaliser et indexer les logs}
\textbf{NORMALISATION} : La normalisation des logs est un processus d’uniformisation des données collectées qui, quelque soit la source, détecte le type de donnée pour intégrer chaque information dans une base de données. Par exemple plusieurs équipements différents écrivent chacun dans un de leur journal d’activité l’adresse IP source, la date, l’heure et l’activité. Chaque équipement aura son format particulier, il va donc falloir les analyser pour détecter et labelliser chaque information utile. Sur ce point, les constructeurs d’équipement et les éditeurs de solutions SIEM travaillent ensemble afin de proposer des modules de normalisation qui couvrent la plupart des usages clients. De plus de nombreux formats de solutions de log sont nativement pris en charge par les SIEM. Les informations sont ensuite indexées pour optimiser les temps de traitement de l’information.
\subsubsection {Corréler les logs}
\g{CORRELATION} : La valeur ajoutée du SIEM vis-à-vis d’un simple serveur de « log», se joue en grande partie sur la corrélation. En effet, ici il est question de pouvoir mettre en évidence des activités en analysant conjointement plusieurs évènements de sources différentes. Bien que ces évènements puissent paraître anodins de manière isolé, ensemble ils forment un indicateur de compromission. Cette corrélation se base sur des règles forgées à partir de cas d’usage (\textit{USE CASE})

\subsubsection {Analyser et alerter}
\textbf{ALERTE} : Ensuite il faut analyser le contenu corrélé pour faire le tri entre les faux positifs et les vrais positifs. Il y a aussi la détection de menace dont le but est de comparer des IOC à des listes de sources malveillantes provenant d’adresse IP, de nom de domaine, de signature de code malveillant, etc. Chaque solution propose ses propres algorithmes d’évaluation du risque lié aux évènements analysés. Une fois les analyses réalisées, des mécanismes peuvent déclencher des alertes si un seuil a été franchi. 
\subsubsection {Réponse graduelle}
Il est possible de proposer des actions d’isolation ou de réponse automatisée. Par exemple : Si les «logs» d’un Anti-virus analyse la présence d’un rançongiciel assimilable au logiciel malveillant «Wannacry» et que le poste en question fait des tentatives de connexions extérieures vers le port 445, il est possible de déclencher un isolement de la machine du réseau à l’aide d’un script ou de l’agent présent sur le poste. 





% TODO Voir article sur les problèmatique SIEM
% https://www.journaldunet.com/solutions/expert/39767/comprendre-les-raisons-de-l-echec-des-siem-et-sim.shtml

La cyber-protection d'une entreprise est principalement basée sur les outils de protection périmétriques que ceux ci soit des équipements physiques ou qu'ils soient dans le cloud : systèmes de détection d’intrusion (IDS), scanners de vulnérabilités, antivirus ainsi que systèmes de gestion et corrélation d’événements sécurité (SIEM). Lorsqu’il s’agit de superviser un système informatique à grande échelle réparti sur plusieurs sites, il devient vite très difficile de corréler et analyser toutes les sources d’information disponibles en temps réel afin de détecter les anomalies et les incidents suffisamment vite pour réagir efficacement. Cette complexité est due à la quantité d’information générée, au manque d’interropérabilité entre les outils ainsi qu’à leurs lacunes en matière de visualisation.


\subsection {De l'usage d'un SIEM pour la gouvernance}  

À l’heure où les normes et certifications de cyber-sécurité sont de plus en plus nombreuses, le SIEM devient un élément clé de tout système d’information. C’est un moyen relativement simple de répondre à plusieurs exigences de sécurité (Exemple : historisation et suivi des logs, rapports de sécurité, alerting, …) et de prouver sa bonne foi aux autorités de certification ou de suivi. D’autant que le SIEM peut générer des rapports hautement personnalisables selon les exigences des différentes réglementations. 

Ce seul bénéfice suffit à convaincre des organisations de déployer un SIEM. La génération d’un rapport unique traitant tous les événements de sécurité pertinents quelle que soit la source des logs (générés en outre dans des formats propriétaires) fait gagner un temps précieux. En outre la création de tableaux de bord issus des usages de surpervision ou de surveillance du SIEM offre des outils de pilotage de la sécurité. 

\subsubsection{Supervision}
En collectant, corrélant et analysant l’activité du système d’information, le SIEM peut présenter des indicateurs clés de performance (KPI) et des indicateurs clé de risque (KRI).
Les fonctions du SIEM ne sont pas totalement dédiées à la sécurité, on peut donc remonter des informations plus générales concernant l’usage du système d’information. Par exemple, l’outil de source ouverte Elastic Stack, peut être utilisé pour faire du «Business Intelligence» ou du «Big Data». A travers les indicateurs dynamiques et personnalisables, on peut développer un outil de gouvernance du système d’information. Par exemple, connaître l’utilisation de ses boîtes mails, la quantité de pièces jointes échangées comparativement à un service de partage de fichiers.
\subsubsection{ Surveillance}
Le SIEM est capable de faire de la surveillance générale. Le but est de définir des règles de corrélation en capacité de déclencher une alerte ou des règles spécifiques à destination des équipes techniques du SOC. Ces règles peuvent se baser sur l’analyse des menaces, sur des comportements anormaux, ou sur un indicateur de véracité d’une attaque. En termes de surveillance, l’atout du SIEM est de centraliser la gestion des alertes sur une seule interface. 
L’autre atout du SIEM sur les solutions de surveillance d’infrastructure classique, c’est qu’il ne nécessite pas directement d'agent spécifique. l'arrivée de l'analyse des terminaux pour compléter l'analyse réseau  modifie les cultures et offre de nouvelles manière de détecter des codes malveillants en action. 


\subsubsection{Les contreparties du SIEM}
Déployer un SIEM ne suffit pas pour autant à sécuriser complètement votre organisation. Les solutions SIEM présentent des limites qui les rendent inefficaces sans un accompagnement à la hauteur et sans solutions tierces. Contrairement à une solution de sécurité de type IDS ou Firewall, un SIEM ne surveille pas les événements de sécurité mais utilise les données de logs enregistrées par ces derniers. Il est donc essentiel de ne pas négliger la mise en place de ces solutions. 


\subsubsection{Une configuration pointue }
Les SIEM sont des produits complexes qui appellent un accompagnement pour assurer une intégration réussie avec les contrôles de sécurité de l’entreprise et les nombreux hôtes de son infrastructure. 

Il est important de ne pas se contenter d’installer un SIEM avec les configurations du constructeur et/ou par défaut, car elles sont souvent insuffisantes. Les configurations doivent être personnalisées et adaptées aux besoins des utilisateurs. De même concernant les rapports, mieux vaut créer ses propres rapports d’analyse, adaptés aux différentes menaces identifiées. À défaut, le risque est réel de ne pas pouvoir profiter des avantages d’une solution de SIEM. 

\subsubsection{Des investissements à bien anticiper }

La collecte, le stockage et l’analyse des événements de sécurité sont des tâches qui semblent relativement simples. Cependant, leur collecte, stockage et l’exécution des rapports de conformité, l’application des correctifs et l’analyse de tous les événements de sécurité se produisant sur le réseau d’une entreprise n’est pas trivial. Taille des supports de stockage, puissance informatique pour le traitement des informations, temps d’intégration des équipements de sécurité, mise en place des alertes… L’investissement initial peut se compter en centaines de milliers d’euros auquel il faut ajouter le support annuel. 

Intégrer, configurer et analyser les rapports nécessite la compétence d’experts. Pour cette raison, la plupart des SIEM sont gérés directement au sein d’un SOC souvent externalisé. Porteur de grandes promesses, le SIEM mal configuré peut apporter son lot de déceptions. Selon un sondage réalisé auprès de 234 entreprises (Source LeMagIT), 81 \% d’utilisateurs reprochent aux SIEM de produire des rapports contenant trop de bruit de fond et pour 63\% les rapports générés sont difficiles à comprendre. Faire appel à des prestataires externes disposant de l’expertise dans le domaine reste souvent la meilleure solution.  

%TODO Voir SIEM externalisation ou chapitre sur la compétence

\subsubsection{Un grand volume d’alertes à réguler }

Les solutions SIEM s’appuient généralement sur des règles pour analyser toutes les données enregistrées. Cependant, le réseau d’une entreprise génère un nombre très important d'alertes (en moyenne 10000 par jours) qui peuvent être positives ou non. En conséquence, l’identification de potentiels attaques est compliquée par le volume de logs non pertinents. 

La solution consiste à définir des règles précises (en général rédigées par un SOC) et le périmètre à surveiller que faut-il surveiller en priorité ? Le périmétrique ? L’interne ? Réseau/système/application ? Quelle technologie à prioriser ? etc. 

\subsubsection{Une surveillance à exercer 24h/24}

Pour fonctionner correctement, les solutions SIEM nécessitent une surveillance 24h/24 et 7j/7 des journaux et des alertes. Un personnel formé ou une équipe dédiée sont requis pour consulter les journaux, effectuer des examens réguliers et extraire les rapports pertinents.  
 Il s’agit à la fois de disposer des expertises requises, de gagner en lisibilité budgétaire et, aussi, de profiter d’engagements de services. Des conditions à réunir afin que l’investissement dans une solution SIEM marque une étape clé dans la protection de votre organisation contre les menaces avancées.

\subsubsection{Analyse d'impact}
% la complexiste de l'analyse d'impact (si on n'a pas fait le travail <risk vers scneario, il est complexe de remonter de scénario à risque et donc impact sur l'entreprise

% citer les travaux de Lagagec

Un autre problème majeur dans l'usage d'un SIEM est que l'action de comprendre l’impact réel d’une vulnérabilité ou d’une alerte IDS est généralement dévolue à un analyste cybersécurité humain, qui doit lui- même faire le lien entre toutes les informations techniques et sa connaissance de tous les services ou processus liés aux incidents de sécurité détectés sur les composants concernées (serveurs, PC, smartphone, IOT,...) . 

Le projet DRA est une étude complémentaire de CIAP qui vise à fournir une analyse de risque en temps réel, afin de déterminer automatiquement l’impact réel dû à la situation sécurité globale du système et du réseau. Pour cela une nouvelle méthodologie innovante a été développée en combinant un générateur automatique d’arbres d’attaque (attack trees/graphs) et un moteur d’analyse de risque « traditionnel » similaire à EBIOS.

Les systèmes de gestion des informations et événements de sécurité (SIEM) font régulièrement l’objet de critiques acerbes. Complexité, besoins importants en ressources de conseil externes… de nombreuses entreprises ont été déçues par leur expérience du SIEM pour l’implémentation de la supervision de la sécurité.

Mais la technologie n’est plus, désormais, la raison pour laquelle des entreprises peinent à réussir leurs implémentations de SIEM. Les principales plateformes de SIEM ont reçu de véritables transplantations cérébrales, se transformant en entrepôts de données taillés sur mesure pour fournir les performances et l’élasticité requises. Les connecteurs système et les aggrégateurs de logs, autrefois complexes et peu fiables, sont aujourd’hui efficaces, rendant la collecte de données relativement simple.

Mais il y a une limite au SIEM, comme à toute technologie s’appuyant sur des règles : le SIEM doit savoir ce qu’il doit chercher. Aucun boîtier SIEM ne pourra identifier automatiquement, comme par magie, une attaque tirant profit d’une méthode ou d’une vulnérabilité inédite.

Le SIEM joue un rôle important dans la détection d’attaques. Mais pour qu’il puisse détecter les attaques connues et inconnues, l’entreprise qui le déploie doit construire des ensembles de règles qui lui permettront d’identifier des conditions d’attaques et des indicateurs spécifiques à son environnement. Et le tout de manière cohérente. Comment donc construire ces règles ?

\subsubsection{Tout collecter}

\mode<all>{\picframe{Tex/Pictures/img-siem-method}{Cadre méthodologique}{0.8}{lbl-siemmethod}}

Sans disposer de suffisamment de données collectées, le SIEM n’a pas grand chose à analyser. Mais la première étape est de collecter les bonnes données. Et celles-ci sont notamment les logs des équipements réseau, de sécurité  et des serveurs. Ces données sont nombreuses et faciles à obtenir. Ensuite, il faut s’intéresser aux logs de l’infrastructure applicative (bases de données, applications). Les experts du SIEM ajoutent à cela les données remontées par de nombreuses autres sources, comme celles des systèmes de gestion des identités et des accès, les flux réseau, les résultats des scans de vulnérabilités et les données de configurations.

Avec les SIEM, plus il y a de données collectées, mieux c’est. Si possible, autant tout collecter. S’il est nécessaire de définir des priorités, alors mieux vaut se concentrer sur les actifs technologiques critiques, à commencer par les équipements installés dans les environnements sensibles et ceux manipulant des données soumises à régulation, ou encore ceux touchant à la propriété intellectuelle. Le soucis principal de ces outils est souvent le modèle économique et de licence. En effet, le prix est majoritairement basé sur le nombre d'évènement.


\subsection{Construire les règles (UseCase)}

%Exemple de scénario d’attaque : Plusieurs tentatives infructueuses de connexions à un service VPN de l’entreprise. Une connexion réussie sur le VPN avec le même nom d’utilisateur. Un programme suspect installé sur la ressource depuis l‘équipement connecté au VPN. Accès continue depuis cette ressource vers un serveur de base de données. Copie des données de la base de données avec un déversement dans un fichier. Séparément les évènements sont anodins, cependant une fois corrélés, cela ressemble à une tentative d’attaque par «brute force» réussie et un vol de donnée stockée dans la base de donnée.

%TODO MENACE SIEM : Relecture

% Begin DOC`

\mode<all>{\picframe{Tex/Pictures/img-siem-usecase}{Construction des UseCase}{1}{lbl-siemusecase}}


Construire une règle pour SIEM est un processus itératif. Cela signifie qu’il est relativement lent et qu’il doit être affiné, précisé au fil du temps. De nombreuses personnes sont atteintes de la « paralysie de l’analyste » en début de processus, parce qu’il existe des millions de règles pouvant être définies. Ainsi, il est  conseiller de se concentrer sur les menaces les plus pressentes pour déterminer les règles à définir en premier.

Dans le cadre du processus de modélisation, il convient de commencer par un actif important. Pour cela, il faut adopter le point de vue de l’attaquant et chercher ce que l’on pourrait vouloir voler.

Modéliser la menace. Il faut se mettre à la place de l’attaquant et imaginer comment entrer et voler les données. C’est la modélisation de l’attaque, avec énumération de chaque vecteur avec le SIEM. Et il convient de ne pas oublier l’exfiltration car sa modélisation offre une opportunité supplémentaire de détecter l’attaque avant que les données ne se soient envolées. Dans ce processus, il s’agit d’adopter des attentes réalistes car le modèle d’attaque ne peut pas par essence être parfait ni complet. Mais il convient toutefois d’engager le processus de modélisation. Et il n’y a pas de mauvais point de départ.

Affiner les règles. Il convient ensuite de lancer l’attaque contre le SI, telle que modélisée. Les outils pour cela ne manque pas. C’est l’occasion de suivre ce que fait le SIEM. Déclenche-t-il les bonnes alertes ? Au bon moment ? L’alerte fournit-elle suffisamment d’informations pour assister les personnes chargées de la réaction ? Si l’alerte n’est pas adéquate, il convient de revoir le modèle et d’ajuster les règles.

Optimiser les seuils. Avec le temps, il deviendra de plus en plus clair que certaines alertes surviennent trop souvent, et d’autres pas assez. Dès lors, il convient d’ajuster finement les seuils de déclenchement. C’est toujours une question d’équilibre… un équilibre délicat.

Laver, rincer, recommencer. Une fois l’ensemble initial de règles pour ce modèle d’attaque spécifique implémenté et optimisé, il convient de passer au vecteur d’attaque suivant, et ainsi de suite, en répétant le processus en modélisant chaque menace.

Ce processus ne s’arrête jamais. Il y a constamment de nouvelles attaques à modéliser et de nouveaux indicateurs à surveiller. Il est toujours important de suivre les informations de sécurité pour savoir quelles attaques sont en vogue. Les rapports tels que celui de Mandiant sur le groupe APT1 intègrent désormais des indicateurs clairs que chaque organisation peut surveiller avec son SIEM. Armé de ces renseignements sur les menaces et d’un environnement de collecte de données complet, il n’y a plus d’excuse : il est temps de commencer à chercher les attaques avancées qui continuent d’émerger.

Mais avec le temps, il sera nécessaire d’ajouter de nouveaux types de données au SIEM, ce qui impliquera de revoir toutes les règles. Par exemple, le trafic réseau, s’il est capturé et transmis au SIEM, fournira quantité de nouvelles informations à étudier. Mais comment ce regard sur le trafic réseau sera-t-il susceptible d’affecter la manière dont certaines attaques sont traitées ? Quelles autres règles faudrait-il ajouter pour détecter l’attaque plus vite ? Ce ne sont pas des questions triviales : il convient de revoir les règles du SIEM chaque fois qu’est ajoutée une nouvelle source de données (ou retirer, le cas échéant) ; cela peut faire la différence sur la rapidité avec laquelle une attaque est détectée… si elle l’est.

Le plus important aspect de ce processus est la cohérence. Le SIEM n’est pas une technologie du type « installe et oublie ». Il requiert du temps, de l’attention, et d’être alimenté, tout au long de sa vie opérationnelle.

% End DOC


\subsection{Quelques défis des SIEM	}

La problématique globale des SIEM est de corréler de l'événement, la question de fond est la collecte de ses évènements. La collecte de LOG est la principale sources d'événements, toutefois, toute les sources d'événements sont susceptibles d'enrichir la corrélation, en particulier les vulnérabilités, les IOC, les infos de end-point ...
La collecte des informations d'opérations et de renseignements nécessite de la FUSION de capteurs.  Cette fusion chère aux militaires est un premier pas qui prend compte aussi de l'information économique, politiques ou sociale de l'entreprise, car ces événements peuvent \g{matcher} avec des attaques complexes.
  
\subsubsection{L'intelligence artificiel}

%Le traitement de masse permet 
%Mais l'important est que l'IA (ex: vectra) puisse explicquer ses propositions et décisions. 

L’Intelligence artificielle est devenue en quelques années un objetif marketing chez les éditeurs de cybersécurité. Avec un certains succès puisque de nombreuses entreprises disent  utiliser des solutions de sécurité basée sur de l’IA. Certaines solutions s’appuient davantage sur des moteurs de règles sophistiquées que sur de réelles fonctionnalités d’IA. Pour parler d’intelligence artificielle, il faut en effet que la technologie inclut : 

\begin{itemize}
  \item  une capacité de perception de l’environnement au moyen d’un apprentissage supervisé ou non,
  \item  une capacité d’analyse et de résolution de problème, 
  \item   une capacité de proposition d’action, voire de décision autonome.
\end{itemize}

Sur le plan théorique, les apports de l’IA en matière de cybersécurité sont donc nombreux, qu’il s’agisse de prévention, d’anticipation, de détection ou de réaction. Dans la pratique, la détection de vulnérabilités ou de menaces internes ou externes apparaît aujourd’hui l’un des usages les plus matures.  Les systèmes actuels basés sur des signatures montrent encore leurs limites : nombre élevé de faux positifs, incapacité à s’adapter aux dernières menaces, notamment aux APT, lourdeur des bases de signature, ce qui a un impact sur les performances. 

\begin{techworkbox}{SIEM et IA}
L'évolution des SIEM sont orientée par le traitement de masse d'évènement. L'IA du BigData offre des possibilités nouvelles.  L'IA dans la détection d'attaque est un bon sujet pour \fichetech.
\end{techworkbox}

\subsubsection{Quelques SIEMs}

On peut citer  ainsi quelques SIEM non pas pour en faire un publicité particuliers mais simplement pour donner quelques indications sur la provenance ...

% Begin PRZ ===========================
\begin{frame}
\frametitle<presentation>{Quelques SIEM}
\framesubtitle<presentation>{en provenance du Gartner}
% end header PRZ =======================
Le Gartner positionne régulièrement des produits et services dans son magic Quadrant. en 2019, Splunk, IBM QRadar et LogRythm NextGen SIEM sont toujours bien positionnés.
Dell Technologies (RSA NetWitness), Exabeam (Security Management Platform), McAfee (Enterprise Security Manager) et Securonix complètent le carré des Leaders.
Toutefois des entreprises comme Microsoft challenge ces acteurs.
\end{frame}
% end PRZ ===========================


\toolsbox{RSA-Netwitness}{siem}
\toolsbox{Qradar}{siem}


\subsection{Threat Hunting}

\subsubsection{la chasse aux menaces}

La chasse aux menaces dormantes ou aux compromissions (Threat Hunting) fait partie intégrante de la gestion de la menace. 
C'est souvent les équipes \g{Hunters} assure le maintien du contact entre la défense et les attaquants lors d'une attaque en cours. Souvent issus d'équipe de compétences liés à réponse à incident.


% Begin PRZ ===========================
\begin{frame}
\frametitle<presentation>{Threat Hunting}
% end header PRZ =======================
La chasse aux menaces est une tactique permettant de connaître avec plus d'acuité l'environnement de la menace et donc  le degré de risque de cyber-attaques auquel est soumise une entreprise. 

La terminologie threat hunting regroupe plusieurs types d'action et la définition de n'est pas totalement stabilisée. Globalement on y trouve deux grandes classes de \g{\textit{threat hunting}} :

\begin{itemize}
  \item Celles travaillant autour de l'environnent, de la surface d'attaque et qui orientent ses actions sur des méthodes de \g{recherche} permettant de débusquer des menaces latentes ou des menaces dormantes, de les réveiller, de les suivre , de les comprendre pour établir le contact avec l'attaquant.

  \item Et une autre plus active ou proactive dont l'objectif est de rester, conserver le contact avec l'attaquant lors d'une réaction à une alerte.
\end{itemize}


\end{frame}
% end PRZ =========================== 


\subsubsection{Etablir le contact}

Quand on parle d'établir contact, nous parlons d'aller au contact au sens martial du terme. c'est dire en direct de suivre, caractériser la sources de la menace et jouer avec elle.

La méthode de \g{hunter} consiste en premier à dresser un portrait global de la surface d’attaque, tout en identifiant les attaquants potentiels, leurs motifs et leurs façons de faire. Plus précisément, le \g{threat hunting} consiste en une analyse détaillée de différents éléments :

\begin{itemize}
	\item la position de  l’entreprise,  notoriété, popularité sur internet, en analysant en particulier,  les médias traditionnels et les médias sociaux;
	\item l'environnement économique de l’entreprise dont ses fournisseurs, ses clients, ses partenaires, ses employés;
	\item le corpus technologique et physique de l'entreprise, dont les architectures techniques et les mécanismes informatiques avec l'environnement économique ainsi l'environnement sécuritaire de ses relations.
\end{itemize}

Sur la base de cette analyse globale, des SPOF (\textit{Sigle Point Of Failure}) peuvent être trouvés. 

Grace à la visualisation  globale des liens il est possible  decomprendre où, comment, pourquoi et potentiellement par qui (activistes, anciens employés, fournisseurs, etc.) la prochaine attaque pourrait être perpétrée. 
Les « threat hunters », ne sont pas simplement en attente de répondre aux alertes du système de défense, ils cherchent activement des menaces dans leurs propres réseaux afin de prévenir ou de minimiser les dommages. Cette méthode s’avère l’une des plus proactives. 


